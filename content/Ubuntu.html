<!DOCTYPE html><html>
        <head>
        <title>wcm2023</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 客製化關閉 -->
        <!--
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        -->
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container">
                <div class="row align-items-center">
                <h1>2023 Spring 網際內容管理</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">2023 Spring 網際內容管理</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li><a href='Motivation.html'>Motivation</a><li><a href='PPython.html'>PPython</a><li><a href='nfulist.html'>nfulist</a><li class='has-children'><a href='Stud.html'>Stud</a><ul class='dropdown'><li><a href='建立 stud.html'>建立 stud</a></li></ul><li><a href='Ref.html'>Ref</a><li><a href='jitsi.html'>jitsi</a><li><a href='Git.html'>Git</a><li><a href='Trends.html'>Trends</a></li></ul><li class='has-children'><a href='WCM.html'>WCM</a><ul class='dropdown'><li class='has-children'><a href='五專.html'>五專</a><ul class='dropdown'><li><a href='ChatGPT.html'>ChatGPT</a><li><a href='cadlab.html'>cadlab</a><li><a href='5jtopics1.html'>5jtopics1</a><li><a href='建立網站.html'>建立網站</a><li><a href='PGP.html'>PGP</a></li></ul><li><a href='jw2.html'>jw2</a><li class='has-children'><a href='四技.html'>四技</a><ul class='dropdown'><li><a href='行前準備.html'>行前準備</a><li><a href='w2-w4.html'>w2-w4</a><li><a href='建網頁.html'>建網頁</a><li><a href='Pull_requests.html'>Pull_requests</a><li><a href='Brython_src.html'>Brython_src</a><li><a href='Resume.html'>Resume</a><li><a href='topics1.html'>topics1</a><li><a href='Brython demo.html'>Brython demo</a></li></ul><li><a href='Ubuntu.html'>Ubuntu</a><li><a href='Windows.html'>Windows</a><li><a href='History.html'>History</a></li></ul><li class='has-children'><a href='Website.html'>Website</a><ul class='dropdown'><li class='has-children'><a href='Javascript.html'>Javascript</a><ul class='dropdown'><li><a href='JQuery.html'>JQuery</a><li><a href='Bootstrap.html'>Bootstrap</a><li><a href='Angular.html'>Angular</a></li></li></ul></ul><li><a href='Reeborg.html'>Reeborg</a><li class='has-children'><a href='cmsimde.html'>cmsimde</a><ul class='dropdown'><li><a href='Resize image.html'>Resize image</a></li></ul><li><a href='LaTeX.html'>LaTeX</a><li class='has-children'><a href='Python.html'>Python</a><ul class='dropdown'><li><a href='Brython.html'>Brython</a><li><a href='ANSIC.html'>ANSIC</a><li><a href='Brython_ex.html'>Brython_ex</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">Brython demo << <a href='Brython demo.html'>Previous</a> <a href='Windows.html'>Next</a> >> Windows<br /><h1>Ubuntu</h1>
<p><a href="https://ubuntu.com/download/server">https://ubuntu.com/download/server</a> (<a href="https://ubuntu.com/about/release-cycle">各版本生命週期</a>)</p>
<p>學習 Ubuntu 操作系統的動機:</p>
<p style="padding-left: 30px;">瞭解業界常用的操作系統除了 Windows, 還有 <a href="https://zh.wikipedia.org/zh-tw/linux">Linux</a> (<a href="https://zh.wikipedia.org/zh-tw/UNIX">Unix</a>) 以及 <a href="https://zh.wikipedia.org/wiki/%E9%BA%A6%E9%87%91%E5%A1%94%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F">Mac OS</a>: <a href="https://link.springer.com/book/10.1007/978-1-4842-3000-8">2017 Beginning Ubuntu for Windows and Mac Users 電子書</a> (可在學校網路下載)</p>
<p style="padding-left: 30px;">便於涉入 Robotics 機器人領域: <a href="https://link.springer.com/book/10.1007/978-1-4842-7750-8">2022 Robot Operating System (ROS) for Absolute Beginners 電子書</a> (可在學校網路下載)</p>
<p style="padding-left: 30px;">想要跨操作系統進行程式開發: <a href="https://link.springer.com/book/10.1007/978-1-4842-6873-5">2021 Pro Windows Subsystem for Linux (WSL) 電子書</a> (可在學校網路下載)</p>
<hr/>
<p>若要讓虛擬主機作為 Server 直接連外, 虛擬網路卡可設為 Bridged, 以橋接從宿主電腦的實體網路卡對外連線.</p>
<p style="padding-left: 30px;">Network 設為橋接 (Bridged):</p>
<p style="padding-left: 60px;">disable IPv4</p>
<p style="padding-left: 60px;">manual IPv6</p>
<p style="padding-left: 90px;">2001:288:6004:17:2023:X:課號:學號末四碼</p>
<p style="padding-left: 90px;">五專 wcm 課號: 2464</p>
<p style="padding-left: 90px;">四技 wcm 課號: 0739</p>
<p style="padding-left: 90px;">五專: X = 0</p>
<p style="padding-left: 90px;">四技一: X = 1</p>
<p style="padding-left: 90px;">四技二: X = 2 依此類推</p>
<p style="padding-left: 90px;">DNS server: 2001:b000:168::1</p>
<p style="padding-left: 90px;">Gateway: 2001:288:6004:17::254</p>
<p style="padding-left: 60px;">Install OpenSSH server</p>
<p>若虛擬主機只是要先能夠上網, 隨後再設法透過 Port mapping 成為 Server, 則虛擬網路卡可設為 Default 的 NAT, 表示要將宿主電腦視為 NAT, 虛擬主機的網路卡使用內部 IP.</p>
<p style="padding-left: 30px;">Network 設為 NAT (Network Address Transfer):</p>
<p style="padding-left: 60px;">若要使用 IPv4 或 IPv6 網路協定上網, 可視宿主所提供的網路協定, 將虛擬網路卡以 DHCP 取得網路位址與 DNS 設定.</p>
<p>若虛擬主機並不上網, 而是要在宿主中設定多台互相連線的虛擬主機, 則可將虛擬網路卡設為 Host only, 各虛擬主機則使用自訂的內部網路位址區段進行設定.</p>
<p style="padding-left: 30px;">Network 設為 Host only:</p>
<p style="padding-left: 60px;">虛擬主機可經由內部網路區段與宿主電腦連接.</p>
<hr/>
<p>學習 Ubuntu 最好的方式之一是採用虛擬主機, 無論在網路修改設定或相關套件安裝測試, 都能採用與實體主機相同的方式進行.</p>
<p>安裝 Ubuntu 操作系統最重要的步驟, 應該是網路設定:</p>
<p>當 Ubuntu 操作系統網路設定完成後, 通常會進行系統更新:</p>
<p style="padding-left: 30px;">sudo apt update</p>
<p style="padding-left: 30px;">sudo apt upgrade</p>
<p style="padding-left: 30px;">sudo apt autoremove</p>
<p>上列 apt 指令說明:</p>
<p>apt update:</p>
<p style="padding-left: 30px;">apt update fetches the latest version of the package list from your distro's software repository, and any third-party repositories you may have configured. In other words, it'll figure out what the latest version of each package and dependency is, but will not actually download or install any of those updates. (<a href="https://www.freecodecamp.org/news/sudo-apt-get-update-vs-upgrade-what-is-the-difference/">source</a>)</p>
<p>apt upgrade:</p>
<p style="padding-left: 30px;">apt upgrade downloads and installs the updates for each outdated package and dependency on your system. But just running sudo apt-get upgrade will not automatically upgrade the outdated packages – you'll still have a chance to review the changes and confirm that you want to perform the upgrades. (<a href="https://www.freecodecamp.org/news/sudo-apt-get-update-vs-upgrade-what-is-the-difference/">source</a>)</p>
<p>apt autoremove:</p>
<p style="padding-left: 30px;">apt autoremove is used to remove packages that were automatically installed to satisfy dependencies for other packages and are now no longer needed as dependencies changed<br/>or the package(s) needing them were removed in the meantime.</p>
<p>Ubuntu 可採 netplan 配置網路:</p>
<p style="padding-left: 30px;">設定檔案位於 /etc/netplan/ 目錄下, 副檔名為 .yaml</p>
<p style="padding-left: 30px;">修改後必須透過 sudo netplan apply 讀取新修改後的設定檔案</p>
<p style="padding-left: 30px;">net.yaml 範例檔案:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false"># This is the network config written by 'subiquity'
network:
  ethernets:
    enp0s3:
      addresses:
        - 2001:288:6004:xx::xx/64
      nameservers:
        addresses:
        - 2001:b000:168::1
      routes:    
        - to: default
          via: 2001:288:6004:xx::254
  version: 2</pre>
<p>安裝 stunnel:</p>
<p>sudo apt install stunnel</p>
<p>stunnel.conf 設定:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">[https]
accept = project.cycu.org:443
connect = 127.0.0.1:9443
cert = fullchain.pem
key = privkey.pem
TIMEOUTclose = 0</pre>
<p>stunnel 服務重新啟動: sudo /etc/init.d/stunnel4 restart<br/><br/>以系統服務設定 stunnel4:<br/><br/>sudo systemctl enable stunnel4.service</p>
<p>設定 Letsencrypt:</p>
<p style="padding-left: 30px;">sudo snap install core; sudo snap refresh core</p>
<p>snap proxy setup:</p>
<p style="padding-left: 30px;">sudo vi /etc/environment and add the following proxy settings:</p>
<p style="padding-left: 30px;">http_proxy=http://127.0.0.1:3128</p>
<p style="padding-left: 30px;">https_proxy=http://127.0.0.1:3128</p>
<p style="padding-left: 30px;">然後以 sudo systemctl restart snapd 重新啟動 snapd 讓 proxy 設定生效</p>
<p>Install certbot:</p>
<p style="padding-left: 30px;">sudo snap install --classic certbot</p>
<p>Prepare certbot command:</p>
<p style="padding-left: 30px;">sudo ln -s /snap/bin/certbot /usr/bin/certbot</p>
<p>Get certificate:</p>
<p style="padding-left: 30px;">sudo certbot certonly --standalone</p>
<p>Install pip3:</p>
<p style="padding-left: 30px;">sudo apt install python3-pip</p>
<p>Install modules for cmsimde:</p>
<p style="padding-left: 30px;">sudo pip3 install flask flask_cors bs4 lxml pelican markdown pyopenssl</p>
<p>Install waitress:</p>
<p style="padding-left: 30px;">sudo pip3 waitress</p>
<p>cp nocache.py:</p>
<p style="padding-left: 30px;">cp cmsimde/nocache.py nocache.py</p>
<p>For github ssh, install ncat:</p>
<p style="padding-left: 30px;">sudo apt install ncat</p>
<p>Secure .ssh/id_rsa:</p>
<p style="padding-left: 30px;">chmod og-rwx .ssh/id_rsa</p>
<p>Web-based acp to work:</p>
<ol>
<li>.ssh/id_rsa only user can read</li>
<li>acp is executable</li>
<li>.git/config url is ether token or SSH based protocol</li>
<li>nocache.py on root directory</li>
<li>server.py</li>
<li>waitress and all cmsimde modules is installed</li>
<li>ncat is installed</li>
</ol>
<p>假如採用 Virtualbox Windows 虛擬主機, 則可以透過 <a href="https://nssm.cc/download">nssm</a> 設定服務:</p>
<p style="padding-left: 30px;">nssm install ubuntu_for_project</p>
<p style="padding-left: 30px;">VBoxHeadless.exe --startvm "Ubuntu_2204_for_project"</p>
<p style="padding-left: 30px;">並且以管理者身分設定 log on 啟動</p>
<p>Use Python to delete user account and directory:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import os
name = input("Username: ")
choice = input("Keep home directory? [Y/n]")
if choice == 'n':
    os.system("sudo deluser --remove-home "+name)
    print("User deleted")
else:
    os.system("sudo deluser "+name)
    print("User deleted")</pre>
<p>Change user shell:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import os
with open("users.txt", "r", encoding="UTF-8") as f:
    data = f.read().splitlines()
for i in data:
    account = i.split(":")[0]
    print(account)
    os.system("sudo chsh -s /bin/bash " + account)</pre>
<p>getps:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">#! /bin/bash
ps axo pid,comm,user | grep "python3"</pre>
<p>getdir + process id:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">pwdx $1
</pre>
<p>server.py</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">from waitress import serve
from cmsimde import flaskapp

serve(flaskapp.app, listen='127.0.0.1:各學員9開頭的內部埠號', threads=8)
</pre>
<p>列出 Ubuntu 中 port 使用相關資訊: lsof -i :9123</p>
<p>lsof: list open files</p>
<p>-i: selects the listing of files any of whose Internet address matches the address specified in i.  If no address is specified, this option selects the listing of all Internet and x.25 (HP-UX) network files.</p>
<p>列出目前系統用戶 GID and UID</p>
<p>cut -d: -f1,3 /etc/passwd</p>
<p>users.txt 格式:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">wcmuser1:password1:1002:1002:wcmuser1:/home/wcmuser1:/bin/bash
wcmuser2:password2:1003:1003:wcmuser2:/home/wcmuser2:/bin/bash
wcmuser3:password3:1004:1004:wcmuser3:/home/wcmuser3:/bin/bash</pre>
<p>新增上列三名新用戶指令:</p>
<p>sudo newusers users.txt</p>
<p>Add super user account:</p>
<p style="padding-left: 30px;">新增 username 帳號, 並授予管理者權限.<br/><br/>sudo adduser username<br/><br/>sudo usermod -aG sudo username</p>
<p>Delete user account:</p>
<p style="padding-left: 30px;">sudo deluser --remove-home account_name</p>
<p>列出 user id:</p>
<p style="padding-left: 30px;">列出現有帳號 uid 的指令為: cut -d: -f1,3 /etc/passwd<br/><br/>表示要從 /etc/passwd 檔案, 以 : 符號分割檔案, 然後只取出第一與第三欄位的資料.</p>
<p></p>
<br />Brython demo << <a href='Brython demo.html'>Previous</a> <a href='Windows.html'>Next</a> >> Windows</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        